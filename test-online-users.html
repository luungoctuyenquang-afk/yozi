<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MQTTèŠå¤©å®¤åœ¨çº¿äººæ•°åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-header {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .feature-demo {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            margin: 15px 0;
        }
        .test-step {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 3px solid #28a745;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.secondary {
            background: #28a745;
        }
        .test-button.secondary:hover {
            background: #218838;
        }
        .highlight {
            background: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .code {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            border: 1px solid #dee2e6;
            margin: 8px 0;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-header">ğŸ§ª MQTTèŠå¤©å®¤åœ¨çº¿äººæ•°åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="feature-demo">
            <h3>âœ¨ æ–°åŠŸèƒ½ä»‹ç»</h3>
            <p><strong>åœ¨çº¿äººæ•°æ˜¾ç¤ºï¼š</strong>å®æ—¶æ˜¾ç¤ºå½“å‰æˆ¿é—´å†…çš„åœ¨çº¿äººæ•°</p>
            <p><strong>åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼š</strong>ç‚¹å‡»äººæ•°å¯å±•å¼€æŸ¥çœ‹æ‰€æœ‰åœ¨çº¿ç”¨æˆ·</p>
            <p><strong>ç”¨æˆ·çŠ¶æ€è·Ÿè¸ªï¼š</strong>è‡ªåŠ¨è·Ÿè¸ªç”¨æˆ·çš„åŠ å…¥å’Œç¦»å¼€</p>
            <p><strong>è§†è§‰åŒºåˆ†ï¼š</strong>è‡ªå·±åœ¨ç”¨æˆ·åˆ—è¡¨ä¸­ä¼šç‰¹æ®Šæ ‡æ³¨"(æˆ‘)"</p>
        </div>

        <div class="demo-grid">
            <div>
                <h3>ğŸ¯ æµ‹è¯•æ­¥éª¤</h3>
                <div class="test-step">
                    <strong>ç¬¬1æ­¥ï¼š</strong> æ‰“å¼€è™šæ‹Ÿæ‰‹æœºåº”ç”¨
                    <br><button class="test-button" onclick="openApp()">æ‰“å¼€åº”ç”¨</button>
                </div>
                
                <div class="test-step">
                    <strong>ç¬¬2æ­¥ï¼š</strong> ç‚¹å‡»"èŠå¤©å®¤"å›¾æ ‡è¿›å…¥MQTTèŠå¤©å®¤
                </div>
                
                <div class="test-step">
                    <strong>ç¬¬3æ­¥ï¼š</strong> è¾“å…¥æˆ¿é—´å·å’Œæ˜µç§°ï¼Œç‚¹å‡»è¿æ¥
                    <br><span class="info">å»ºè®®æˆ¿é—´å·ï¼štest-room-online</span>
                </div>
                
                <div class="test-step">
                    <strong>ç¬¬4æ­¥ï¼š</strong> è§‚å¯Ÿ<span class="highlight">ğŸ‘¥ åœ¨çº¿äººæ•°ï¼š1</span>æ˜¾ç¤º
                </div>
                
                <div class="test-step">
                    <strong>ç¬¬5æ­¥ï¼š</strong> ç‚¹å‡»åœ¨çº¿äººæ•°ï¼ŒæŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
                    <br><span class="success">åº”è¯¥æ˜¾ç¤ºä½ çš„æ˜µç§° + "(æˆ‘)"</span>
                </div>
            </div>

            <div>
                <h3>ğŸ§ª é«˜çº§æµ‹è¯•</h3>
                <div class="test-step">
                    <strong>å¤šç”¨æˆ·æµ‹è¯•ï¼š</strong> 
                    <br><button class="test-button secondary" onclick="openMultiple()">æ‰“å¼€å¤šä¸ªçª—å£</button>
                    <br><small>ä½¿ç”¨ä¸åŒæ˜µç§°è¿æ¥åŒä¸€æˆ¿é—´</small>
                </div>
                
                <div class="test-step">
                    <strong>æ–­çº¿æµ‹è¯•ï¼š</strong> å…³é—­ä¸€ä¸ªçª—å£ï¼Œè§‚å¯Ÿå…¶ä»–çª—å£çš„åœ¨çº¿äººæ•°å˜åŒ–
                </div>
                
                <div class="test-step">
                    <strong>é‡è¿æµ‹è¯•ï¼š</strong> æ–­å¼€è¿æ¥åé‡æ–°è¿æ¥ï¼ŒéªŒè¯äººæ•°ç»Ÿè®¡å‡†ç¡®æ€§
                </div>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2 class="test-header">ğŸ” åŠŸèƒ½éªŒè¯æ¸…å•</h2>
        
        <div id="checklistContainer">
            <label><input type="checkbox" id="check1"> è¿æ¥ååœ¨çº¿äººæ•°æ˜¾ç¤ºä¸º1</label><br>
            <label><input type="checkbox" id="check2"> ç‚¹å‡»äººæ•°å¯å±•å¼€/æŠ˜å ç”¨æˆ·åˆ—è¡¨</label><br>
            <label><input type="checkbox" id="check3"> ç”¨æˆ·åˆ—è¡¨ä¸­è‡ªå·±çš„æ˜µç§°æ ‡æœ‰"(æˆ‘)"</label><br>
            <label><input type="checkbox" id="check4"> å…¶ä»–ç”¨æˆ·åŠ å…¥æ—¶äººæ•°å¢åŠ </label><br>
            <label><input type="checkbox" id="check5"> å…¶ä»–ç”¨æˆ·ç¦»å¼€æ—¶äººæ•°å‡å°‘</label><br>
            <label><input type="checkbox" id="check6"> æ–­å¼€è¿æ¥æ—¶åœ¨çº¿äººæ•°å½’é›¶</label><br>
            <label><input type="checkbox" id="check7"> åœ¨çº¿ç”¨æˆ·åˆ—è¡¨æ ·å¼ç¾è§‚</label><br>
            <label><input type="checkbox" id="check8"> æ²¡æœ‰JavaScripté”™è¯¯</label><br>
        </div>

        <div style="margin-top: 20px;">
            <button class="test-button" onclick="checkProgress()">æ£€æŸ¥æµ‹è¯•è¿›åº¦</button>
            <button class="test-button secondary" onclick="resetChecklist()">é‡ç½®æ¸…å•</button>
        </div>
        
        <div id="progressResult"></div>
    </div>

    <div class="test-container">
        <h2 class="test-header">ğŸ› ï¸ æŠ€æœ¯å®ç°è¯¦æƒ…</h2>
        
        <div class="code">
            <strong>æ•°æ®ç»“æ„ï¼š</strong><br>
            let onlineUsers = new Set(); // åœ¨çº¿ç”¨æˆ·é›†åˆ<br>
            let userJoinTimes = new Map(); // ç”¨æˆ·åŠ å…¥æ—¶é—´è®°å½•
        </div>
        
        <div class="code">
            <strong>å…³é”®å‡½æ•°ï¼š</strong><br>
            â€¢ addOnlineUser(username) - æ·»åŠ åœ¨çº¿ç”¨æˆ·<br>
            â€¢ removeOnlineUser(username) - ç§»é™¤åœ¨çº¿ç”¨æˆ·<br>
            â€¢ updateOnlineUsersDisplay() - æ›´æ–°UIæ˜¾ç¤º
        </div>
        
        <div class="code">
            <strong>äº‹ä»¶å¤„ç†ï¼š</strong><br>
            â€¢ presence/join æ¶ˆæ¯ â†’ æ·»åŠ ç”¨æˆ·åˆ°åœ¨çº¿åˆ—è¡¨<br>
            â€¢ presence/leave æ¶ˆæ¯ â†’ ä»åœ¨çº¿åˆ—è¡¨ç§»é™¤ç”¨æˆ·<br>
            â€¢ è¿æ¥æˆåŠŸ â†’ æ·»åŠ è‡ªå·±ï¼Œæ¸…ç©ºæ—§æ•°æ®<br>
            â€¢ æ–­å¼€è¿æ¥ â†’ æ¸…ç©ºæ‰€æœ‰åœ¨çº¿ç”¨æˆ·
        </div>
    </div>

    <div class="test-container">
        <h2 class="test-header">ğŸ› å·²çŸ¥é™åˆ¶å’Œæ”¹è¿›å»ºè®®</h2>
        
        <div class="test-step">
            <strong>å½“å‰é™åˆ¶ï¼š</strong>
            <ul>
                <li>ä»…æ˜¾ç¤ºå½“å‰ä¼šè¯æœŸé—´åŠ å…¥çš„ç”¨æˆ·</li>
                <li>æ— æ³•æ˜¾ç¤ºè¿æ¥å‰å·²åœ¨æˆ¿é—´çš„ç”¨æˆ·</li>
                <li>ä¾èµ–MQTT Last Willæœºåˆ¶å¤„ç†æ„å¤–æ–­çº¿</li>
            </ul>
        </div>
        
        <div class="test-step">
            <strong>æœªæ¥ä¼˜åŒ–æ–¹å‘ï¼š</strong>
            <ul>
                <li>æ·»åŠ "è°åœ¨æˆ¿é—´"æŸ¥è¯¢æœºåˆ¶</li>
                <li>æ˜¾ç¤ºç”¨æˆ·åœ¨çº¿æ—¶é•¿</li>
                <li>ç”¨æˆ·å¤´åƒæˆ–çŠ¶æ€å›¾æ ‡</li>
                <li>æœ€å¤§åœ¨çº¿äººæ•°ç»Ÿè®¡</li>
            </ul>
        </div>
    </div>

    <script>
        function openApp() {
            window.open('http://localhost:3000', '_blank', 'width=400,height=800');
        }
        
        function openMultiple() {
            // æ‰“å¼€3ä¸ªçª—å£ç”¨äºå¤šç”¨æˆ·æµ‹è¯•
            for (let i = 1; i <= 3; i++) {
                setTimeout(() => {
                    window.open('http://localhost:3000', `_blank_${i}`, 'width=350,height=700,left=' + (i * 380));
                }, i * 500);
            }
            alert('å·²æ‰“å¼€3ä¸ªæµ‹è¯•çª—å£ï¼Œè¯·ä½¿ç”¨ä¸åŒæ˜µç§°è¿æ¥åˆ°åŒä¸€æˆ¿é—´è¿›è¡Œå¤šç”¨æˆ·æµ‹è¯•');
        }
        
        function checkProgress() {
            const checkboxes = document.querySelectorAll('#checklistContainer input[type="checkbox"]');
            const total = checkboxes.length;
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const percentage = Math.round((checked / total) * 100);
            
            let result = `<div style="margin-top: 15px; padding: 15px; border-radius: 8px; `;
            
            if (percentage === 100) {
                result += `background: #d4edda; color: #155724;">
                    ğŸ‰ <strong>æµ‹è¯•å®Œæˆï¼</strong> æ‰€æœ‰åŠŸèƒ½éªŒè¯é€šè¿‡ (${checked}/${total})
                    <br>åœ¨çº¿äººæ•°åŠŸèƒ½å·²æˆåŠŸé›†æˆå¹¶æ­£å¸¸å·¥ä½œï¼`;
            } else if (percentage >= 70) {
                result += `background: #fff3cd; color: #856404;">
                    âš ï¸ <strong>åŸºæœ¬åŠŸèƒ½æ­£å¸¸</strong> è¿›åº¦: ${checked}/${total} (${percentage}%)
                    <br>å»ºè®®å®Œæˆå‰©ä½™æµ‹è¯•é¡¹ç›®ä»¥ç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§`;
            } else {
                result += `background: #f8d7da; color: #721c24;">
                    âŒ <strong>éœ€è¦è¿›ä¸€æ­¥æµ‹è¯•</strong> è¿›åº¦: ${checked}/${total} (${percentage}%)
                    <br>è¯·æŒ‰ç…§æµ‹è¯•æ­¥éª¤è¿›è¡ŒåŠŸèƒ½éªŒè¯`;
            }
            
            result += `</div>`;
            document.getElementById('progressResult').innerHTML = result;
        }
        
        function resetChecklist() {
            const checkboxes = document.querySelectorAll('#checklistContainer input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            document.getElementById('progressResult').innerHTML = '';
        }
        
        // é¡µé¢åŠ è½½æ—¶çš„è¯´æ˜
        window.onload = function() {
            console.log('ğŸš€ MQTTèŠå¤©å®¤åœ¨çº¿äººæ•°åŠŸèƒ½æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('ğŸ“‹ è¯·æŒ‰ç…§é¡µé¢ä¸Šçš„æ­¥éª¤è¿›è¡ŒåŠŸèƒ½æµ‹è¯•');
            console.log('ğŸ’¡ å»ºè®®åŒæ—¶æ‰“å¼€å¤šä¸ªçª—å£æµ‹è¯•å¤šç”¨æˆ·åœºæ™¯');
        };
    </script>
</body>
</html>
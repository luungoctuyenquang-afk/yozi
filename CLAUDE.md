# 虚拟手机AI伴侣项目

## 项目概述
- 浏览器端虚拟手机Demo + AI伴侣系统
- 纯前端架构，无打包器，脚本按序加载
- 核心功能：AI对话、世界书系统、虚拟经济、PWA

## 技术栈
- 前端：原生JS（全局对象模式）
- 存储：IndexedDB (Dexie) + localStorage
- AI接口：Gemini/OpenAI兼容
- 世界书引擎：TypeScript (tsup构建)
- PWA：Service Worker离线缓存

## 开发约定
1. **零代码基础友好**：所有修改需提供完整替换代码
2. **全局对象依赖**：注意脚本加载顺序
3. **向后兼容**：保持历史数据兼容性
4. **修改格式**：
   - 根本原因分析
   - 解决方案说明
   - 文件定位
   - 修改前后对比

## 🔴 重要：代码组织原则
**严格要求：代码修改必须按功能分离到对应文件，禁止将所有逻辑塞进单个文件！**

文件职责划分：
- **index.html** - HTML结构和DOM元素
- **style.css** - 所有CSS样式
- **manifest.json** - PWA配置
- **sw.js** - Service Worker
- **js/config.js** - 全局配置
- **js/state.js** - 状态管理
- **js/database.js** - 数据持久化
- **js/ai.js** - AI接口层
- **js/utils.js** - 工具函数
- **js/screens/*.js** - 各界面模块

修改规则：
- 新功能 → 创建新的js文件
- UI界面 → js/screens/新文件
- 样式修改 → style.css
- HTML结构 → index.html
- PWA配置 → manifest.json

每个模块保持单一职责，严禁功能混杂！

## 🔴 重要：项目实用性原则
**必须明确：这是一个实际可用的虚拟手机AI伴侣项目，不是UI框架或样式展示！**

实用性要求：
- **真实可用** - 这是一个完整的、可运行的项目，不是demo或框架
- **功能完整** - 每个功能都要能实际工作，有真实的交互和数据处理
- **注重体验** - 所有改动都要有实际用途，提升用户体验
- **避免空壳** - 禁止只有样式没有功能的空壳设计

开发重点：
- AI对话要能真实响应
- 数据要能正确存储和读取
- 界面交互要流畅自然
- 功能之间要协调工作

记住：用户使用的是一个**实际的应用**，不是在看一个样式框架！

## 🔴 重要：修改流程要求
**用户提出需求后，必须先说明修改方案，等待用户确认后再执行！**

修改流程：
1. **分析需求** - 理解用户要实现什么
2. **提出方案** - 详细说明：
   - 需要修改哪些文件
   - 每个文件的修改内容概述
   - **改动后的效果**：
     * 界面会变成什么样（如：新增什么按钮、颜色变化等）
     * 功能会有什么变化（如：点击后会发生什么）
     * 用户体验的改变（如：操作流程的变化）
   - 可能的影响或风险
3. **等待确认** - 用户说"执行"、"好"、"下一步"等确认词后再开始
4. **执行修改** - 按方案逐步修改代码
5. **验证结果** - 确保功能正常

示例说明格式：
```
修改方案：
1. 文件：style.css
   - 添加新按钮样式（蓝色背景，白色文字）

2. 文件：index.html
   - 在顶部导航栏添加"新功能"按钮

3. 文件：js/screens/new-feature.js
   - 创建新功能模块，点击按钮后弹出对话框

改动后效果：
- 界面：顶部会多一个蓝色的"新功能"按钮
- 功能：点击按钮会弹出设置对话框
- 体验：用户可以快速访问新功能，不需要进入设置页面
```

禁止未经确认就直接修改代码！

## 常用命令
- `npm start` - 启动开发服务器(3000端口)
- `npm run build` - 构建WorldBook引擎
- `npm test` - 运行测试

## 重要文件
- 入口：index.html, js/main.js
- AI核心：js/ai.js
- 状态管理：js/state.js
- 数据库：js/database.js
- 界面：js/screens/*.js
- 世界书：worldbook/*.ts → public/worldbook/

## 当前进度
- ✅ 世界书系统基本完善
- 🔧 交互框架开发中
- ⏳ 待完成：[根据实际情况更新]